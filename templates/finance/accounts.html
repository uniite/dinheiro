{% extends "base.html" %}

{% block scripts %}
<script>
var app = angular.module("Dinheiro", ["ngResource"]);

app.config(['$routeProvider', function($routeProvider) {
    $routeProvider.
      when('/accounts', {templateUrl: '/static/partials/account-list.html',   controller: "AccountListCtrl"}).
      when('/accounts/:id', {templateUrl: '/static/partials/account-detail.html', controller: "AccountDetailCtrl"}).
      otherwise({redirectTo: '/accounts'});
}]);

app.factory("Account", function ($resource) {
    return $resource("/finance/api/accounts/:id?format=json", {id: "@id"});
});
app.factory("Transaction", function ($resource) {
    return $resource("/finance/api/transactions/:id?format=json", {id: "@id"});
});

app.controller("AccountListCtrl", ["$scope", "Account",
    function AccountListCtrl($scope, Account) {
        $scope.accounts = Account.query();
}]);

app.controller("AccountDetailCtrl", ["$scope", "$routeParams", "Account", "Transaction",
    function AccountDetailCtrl($scope, $routeParams, Account, Transaction) {
        $scope.account = Account.get({id: $routeParams.id});
        $scope.transactions = Transaction.query();
}]);
</script>
{% endblock %}

{% block content %}
{% verbatim %}
    <div ng-view></div>
{% endverbatim %}
{% endblock %}
